/**
 * jQuery-multiAutocomplete
 * @version: v1.0.0
 * @author: Israel Moraes
 * 
 * Created by Israel Moraes on 2020-07-13. Please report any bug at https://github.com/IsraelFM/jQuery-multiAutocomplete
 *
 * Developed with UMD (Universal Module Definition) patterns for JavaScript modules that work everywhere.
 * https://github.com/umdjs/umd/blob/master/templates/jqueryPlugin.js
 */

e=function(e){"use strict";const t=function(t,o,i){let l,u={events:function(){t.on("keydown.multiAutocomplete",(function(t){if(t.keyCode===s.SPACE&&(t.metaKey||t.ctrlKey?u.createSuggestionContainers():c.hide()),t.keyCode===s.UP||t.keyCode===s.DOWN)return!1;if(-1!==e.inArray(t.keyCode,a.options.stopSuggestionKeys)){if(c.children().length>0){let e=c.find(`.${a.class.suggestion}.${a.class.selected}`).html();u.updateSelection(u.getCompletion(e))}return!1}})).on("keyup.multiAutocomplete",(function(e){let t,n=e.altKey||e.metaKey||e.ctrlKey,o=a.class.suggestion,i=a.class.selected;switch(e.keyCode){case s.LEFT:case s.RIGHT:case s.TAB:case s.BACKSPACE:case s.DEL:(c.is(":visible")||a.options.autosuggest)&&u.createSuggestionContainers();break;case s.ESC:c.hide();break;case s.UP:a.selectedIndex>0&&(t=c.find(`.${o}:not(:first-child).${i}`).removeClass(i).prev().addClass(i),a.selectedIndex=t.data("index"),t.get(0).scrollIntoView({block:"nearest"}));break;case s.DOWN:a.selectedIndex<c.children().length-1&&(t=c.find(`.${o}:not(:last-child).${i}`).removeClass(i).next().addClass(i),a.selectedIndex=t.data("index"),t.get(0).scrollIntoView({block:"nearest"}));break;default:(c.is(":visible")||!n&&a.options.autosuggest)&&u.getChunk().length>=a.options.minChunkSize&&u.createSuggestionContainers()}})).on("blur.multiAutocomplete",(function(){l=setTimeout((function(){c.hide()}),200)})),c.on("mouseout.multiAutocomplete",(function(){e("."+a.class.suggestion).removeClass(a.class.hover)})).on("mouseover.multiAutocomplete","."+a.class.suggestion,(function(){e("."+a.class.suggestion).eq(e(this).data("index")).addClass(a.class.hover)})).on("click.multiAutocomplete","."+a.class.suggestion,(function(){let e=c.find(`.${a.class.suggestion}.${a.class.hover}`).html();u.updateSelection(u.getCompletion(e)),c.hide(),t.focus(),clearTimeout(l)}))},destroyEvents:function(){t.off(["keydown","keyup","blur","mouseover","mouseover","click",""].join(".multiAutocomplete "))},getChunk:function(){let e,s,n=a.options.delimiters.split(""),o=t.val().substr(0,u.getInputSelection(t).start),i=-1;for(let t=0;t<n.length;t++)e=n[t],s=o.lastIndexOf(e),s>i&&(i=s);return i<0?o:o.substr(i+1)},updateSelection:function(e){let s=u.getInputSelection(t),n=s.start,o=n+e.length;if(s.elDOM.setRangeText)s.elDOM.setRangeText(e);else{let s=t.val().substring(0,n),i=t.val().substring(o,t.val().length),l=t.val().substring(n,o);t.val(s+e+l+i)}s.elDOM.setSelectionRange(o,o)},createSuggestionContainers:function(){let e,t=u.getChunk(),s="",n=0;if(a.options.prefixRegexps.test(t))for(let i=0;i<o.length;i++)e=o[i],a.options.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),0===e.indexOf(t)&&(s+=`<div class="${a.class.suggestion} ${0===n?a.class.selected:""}" data-index="${n++}"><strong>${t}</strong>${e.substr(t.length)}</div>`);c.html(s),s?c.show():c.hide(),a.selectedIndex=0},getCompletion:function(e){let t=u.getChunk();return(t+e.replace(/<[^>]*>(.*?)[^>]*>/,"")).substr(t.length)+a.options.endingSymbols},getInputSelection:function(e){let t=0,s=0;return"number"==typeof(e=e.get(0)).selectionStart&&"number"==typeof e.selectionEnd&&(t=e.selectionStart,s=e.selectionEnd),{elDOM:e,start:t,end:s}}};t=e(t);let c,a=this;a.suggestions=o,a.options=i,a.destroy=function(){return u.destroyEvents(),t},a.init=function(s){if(s){a.options=e.extend({},e.jPluginDefaults,i),a.selectedIndex=-1,a.class={suggestions:"multiAutocomplete-suggestions",suggestion:"multiAutocomplete-suggestion",selected:"multiAutocomplete-selected",hover:"multiAutocomplete-hover"};let s=n.createContainer(a.class.suggestions);c=t.after(s).next(),u.destroyEvents(),u.events()}},a.init(t.is("input"))},s={ALT:18,LEFT:37,UP:38,RIGHT:39,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8,SPACE:32},n={createContainer:function(e){let t=document.createElement("div");return t.className=e,t.style.position="absolute",t.style.display="none",t.style["max-height"]="100px",t.style["overflow-y"]="auto",t}};e.fn.multiAutocomplete=function(s,n){return n=n||{},o=e.jPluginDefaults,e(this).each((function(){return e(this).data("multiAutocomplete",new t(this,s,n))})),this},e.fn.destroy=function(){return this.each((function(){let t=e(this).data("multiAutocomplete");t&&t.destroy().removeData("multiAutocomplete")}))};let o={delimiters:" ",minChunkSize:1,autosuggest:!0,endingSymbols:"",prefixRegexps:/.*/,stopSuggestionKeys:[9,13],ignoreCase:!1};e.jPluginDefaults=e.jPluginDefaults||{},o=e.jPluginDefaults=e.extend(!0,{},o,e.jPluginDefaults)},"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports&&"function"==typeof require?module.exports=e(require("jquery")):e(jQuery)